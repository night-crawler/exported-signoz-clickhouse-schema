SELECT
    type,
    ts,
    sum(per_series_value) AS value
FROM
(
    SELECT
        type,
        ts,
        If((per_series_value - lagInFrame(per_series_value, 1, 0) OVER rate_window) < 0, nan, If((ts - lagInFrame(ts, 1, toDate('1970-01-01')) OVER rate_window) >= 86400, nan, (per_series_value - lagInFrame(per_series_value, 1, 0) OVER rate_window) / (ts - lagInFrame(ts, 1, toDate('1970-01-01')) OVER rate_window))) AS per_series_value
    FROM
    (
        SELECT
            fingerprint,
            any(type) AS type,
            toStartOfInterval(toDateTime(intDiv(unix_milli, 1000)), toIntervalSecond(60)) AS ts,
            max(value) AS per_series_value
        FROM signoz_metrics.distributed_samples_v4
        INNER JOIN
        (
            SELECT DISTINCT
                JSONExtractString(labels, 'type') AS type,
                fingerprint
            FROM signoz_metrics.time_series_v4
            WHERE (metric_name IN ['system_paging_faults']) AND (temporality = 'Cumulative') AND (__normalized = true) AND (unix_milli >= 1744743600000) AND (unix_milli < 1744748220000)
        ) AS filtered_time_series USING (fingerprint)
        WHERE (metric_name IN ['system_paging_faults']) AND (unix_milli >= 1744744560000) AND (unix_milli < 1744748220000)
        GROUP BY
            fingerprint,
            ts
        ORDER BY
            fingerprint ASC,
            ts ASC
    )
    WINDOW rate_window AS (PARTITION BY fingerprint ORDER BY fingerprint ASC, ts ASC)
)
WHERE isNaN(per_series_value) = 0
GROUP BY
    type,
    ts
ORDER BY
    type ASC,
    ts ASC

Query id: 087d745f-ba2a-40c0-8cf5-8e03e8259925

┌─type──┬──────────────────ts─┬──────────────value─┐
│ major │ 2025-04-15 19:17:00 │                  0 │
│ major │ 2025-04-15 19:18:00 │                  0 │
│ major │ 2025-04-15 19:19:00 │                  0 │
│ major │ 2025-04-15 19:20:00 │                  0 │
│ major │ 2025-04-15 19:21:00 │                  0 │
│ major │ 2025-04-15 19:22:00 │                  0 │
│ major │ 2025-04-15 19:23:00 │                  0 │
│ major │ 2025-04-15 19:24:00 │                  0 │
│ major │ 2025-04-15 19:25:00 │                  0 │
│ major │ 2025-04-15 19:26:00 │                  0 │
│ major │ 2025-04-15 19:27:00 │                  0 │
│ major │ 2025-04-15 19:28:00 │                  0 │
│ major │ 2025-04-15 19:29:00 │                  0 │
│ major │ 2025-04-15 19:30:00 │                  0 │
│ major │ 2025-04-15 19:31:00 │                  0 │
│ major │ 2025-04-15 19:32:00 │                  0 │
│ major │ 2025-04-15 19:33:00 │                  0 │
│ major │ 2025-04-15 19:34:00 │  341.3333333333333 │
│ major │ 2025-04-15 19:35:00 │                  0 │
│ major │ 2025-04-15 19:36:00 │                  0 │
│ major │ 2025-04-15 19:37:00 │                  0 │
│ major │ 2025-04-15 19:38:00 │ 1706.6666666666667 │
│ major │ 2025-04-15 19:39:00 │ 273.06666666666666 │
│ major │ 2025-04-15 19:40:00 │                  0 │
│ major │ 2025-04-15 19:41:00 │  68.26666666666667 │
│ major │ 2025-04-15 19:42:00 │                  0 │
│ major │ 2025-04-15 19:43:00 │                  0 │
│ major │ 2025-04-15 19:44:00 │                  0 │
│ major │ 2025-04-15 19:45:00 │                  0 │
│ major │ 2025-04-15 19:46:00 │                  0 │
│ major │ 2025-04-15 19:47:00 │              819.2 │
│ major │ 2025-04-15 19:48:00 │                  0 │
│ major │ 2025-04-15 19:49:00 │                  0 │
│ major │ 2025-04-15 19:50:00 │                  0 │
│ major │ 2025-04-15 19:51:00 │                  0 │
│ major │ 2025-04-15 19:52:00 │                  0 │
│ major │ 2025-04-15 19:53:00 │                  0 │
│ major │ 2025-04-15 19:54:00 │  546.1333333333333 │
│ major │ 2025-04-15 19:55:00 │                  0 │
│ major │ 2025-04-15 19:56:00 │ 273.06666666666666 │
│ major │ 2025-04-15 19:57:00 │                  0 │
│ major │ 2025-04-15 19:58:00 │                  0 │
│ major │ 2025-04-15 19:59:00 │                  0 │
│ major │ 2025-04-15 20:00:00 │ 273.06666666666666 │
│ major │ 2025-04-15 20:01:00 │                  0 │
│ major │ 2025-04-15 20:02:00 │                  0 │
│ major │ 2025-04-15 20:03:00 │                  0 │
│ major │ 2025-04-15 20:04:00 │                  0 │
│ major │ 2025-04-15 20:05:00 │                  0 │
│ major │ 2025-04-15 20:06:00 │                  0 │
│ major │ 2025-04-15 20:07:00 │ 136.53333333333333 │
│ major │ 2025-04-15 20:08:00 │  341.3333333333333 │
│ major │ 2025-04-15 20:09:00 │  68.26666666666667 │
│ major │ 2025-04-15 20:10:00 │                  0 │
│ major │ 2025-04-15 20:11:00 │                  0 │
│ major │ 2025-04-15 20:12:00 │  68.26666666666667 │
│ major │ 2025-04-15 20:13:00 │                  0 │
│ major │ 2025-04-15 20:14:00 │            96665.6 │
│ major │ 2025-04-15 20:15:00 │                  0 │
│ major │ 2025-04-15 20:16:00 │                  0 │
│ minor │ 2025-04-15 19:17:00 │ 17405610.666666668 │
│ minor │ 2025-04-15 19:18:00 │         15828582.4 │
│ minor │ 2025-04-15 19:19:00 │         21745459.2 │
│ minor │ 2025-04-15 19:20:00 │         18002739.2 │
│ minor │ 2025-04-15 19:21:00 │         17594572.8 │
│ minor │ 2025-04-15 19:22:00 │         14358937.6 │
│ minor │ 2025-04-15 19:23:00 │ 17857058.133333333 │
│ minor │ 2025-04-15 19:24:00 │ 16581973.333333334 │
│ minor │ 2025-04-15 19:25:00 │         17484185.6 │
│ minor │ 2025-04-15 19:26:00 │           18122752 │
│ minor │ 2025-04-15 19:27:00 │         18553241.6 │
│ minor │ 2025-04-15 19:28:00 │ 20841335.466666665 │
│ minor │ 2025-04-15 19:29:00 │ 30588450.133333333 │
│ minor │ 2025-04-15 19:30:00 │         41284812.8 │
│ minor │ 2025-04-15 19:31:00 │ 20547515.733333334 │
│ minor │ 2025-04-15 19:32:00 │           32031744 │
│ minor │ 2025-04-15 19:33:00 │           31267840 │
│ minor │ 2025-04-15 19:34:00 │         42348134.4 │
│ minor │ 2025-04-15 19:35:00 │         54358835.2 │
│ minor │ 2025-04-15 19:36:00 │           34408448 │
│ minor │ 2025-04-15 19:37:00 │ 31031637.333333332 │
│ minor │ 2025-04-15 19:38:00 │         44657254.4 │
│ minor │ 2025-04-15 19:39:00 │ 33323349.333333332 │
│ minor │ 2025-04-15 19:40:00 │           36969472 │
│ minor │ 2025-04-15 19:41:00 │  35818222.93333333 │
│ minor │ 2025-04-15 19:42:00 │ 37066410.666666664 │
│ minor │ 2025-04-15 19:43:00 │           21048320 │
│ minor │ 2025-04-15 19:44:00 │         21139660.8 │
│ minor │ 2025-04-15 19:45:00 │ 41865284.266666666 │
│ minor │ 2025-04-15 19:46:00 │           32581632 │
│ minor │ 2025-04-15 19:47:00 │  37470344.53333333 │
│ minor │ 2025-04-15 19:48:00 │         18779955.2 │
│ minor │ 2025-04-15 19:49:00 │ 16321399.466666667 │
│ minor │ 2025-04-15 19:50:00 │ 19281237.333333332 │
│ minor │ 2025-04-15 19:51:00 │ 21232913.066666666 │
│ minor │ 2025-04-15 19:52:00 │ 22436727.466666665 │
│ minor │ 2025-04-15 19:53:00 │ 18767121.066666666 │
│ minor │ 2025-04-15 19:54:00 │  39860360.53333333 │
│ minor │ 2025-04-15 19:55:00 │  42584951.46666667 │
│ minor │ 2025-04-15 19:56:00 │ 55193531.733333334 │
│ minor │ 2025-04-15 19:57:00 │  47673890.13333333 │
│ minor │ 2025-04-15 19:58:00 │         35778150.4 │
│ minor │ 2025-04-15 19:59:00 │         28168396.8 │
│ minor │ 2025-04-15 20:00:00 │  41472136.53333333 │
│ minor │ 2025-04-15 20:01:00 │           31732736 │
│ minor │ 2025-04-15 20:02:00 │ 33364241.066666666 │
│ minor │ 2025-04-15 20:03:00 │           15133696 │
│ minor │ 2025-04-15 20:04:00 │ 15317947.733333332 │
│ minor │ 2025-04-15 20:05:00 │           14885888 │
│ minor │ 2025-04-15 20:06:00 │         18467020.8 │
│ minor │ 2025-04-15 20:07:00 │ 24975223.466666665 │
│ minor │ 2025-04-15 20:08:00 │           51262464 │
│ minor │ 2025-04-15 20:09:00 │ 21377774.933333334 │
│ minor │ 2025-04-15 20:10:00 │ 19727018.666666668 │
│ minor │ 2025-04-15 20:11:00 │ 30936951.466666665 │
│ minor │ 2025-04-15 20:12:00 │ 34868565.333333336 │
│ minor │ 2025-04-15 20:13:00 │ 29509085.866666667 │
│ minor │ 2025-04-15 20:14:00 │  34976221.86666667 │
│ minor │ 2025-04-15 20:15:00 │         33466163.2 │
│ minor │ 2025-04-15 20:16:00 │ 35140539.733333334 │
└───────┴─────────────────────┴────────────────────┘

120 rows in set. Elapsed: 0.022 sec. Processed 40.71 thousand rows, 2.60 MB (1.89 million rows/s., 120.37 MB/s.)
Peak memory usage: 4.28 MiB.
